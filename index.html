<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Abdominal Pain</title>
  <link rel="stylesheet" href="styles.css">
  
</head>
<body>
  <!-- Hidden form container -->
  <form id="symptomForm" style="display:none;"></form>

  <div class="header">
    <div class="header-content">
      <h1>Abdominal Pain</h1>
      <button class="generate-btn" type="button" onclick="generateOutput()">Generate Report</button>
    </div>
  </div>

  <!-- Top note -->
  <div style="max-width:1200px;margin:12px auto 0;padding:0 20px;">
    <div class="ux-instruction" role="note" aria-live="polite"></div>
  </div>

  <div class="dashboard" id="dashboard">
    <!-- Initial Information Card -->
    <div class="card">
      <div class="card-header" onclick="toggleCard(this)">
        <h3>Initial Information</h3>
        <span class="card-icon">▼</span>
      </div>
      <div class="card-content">
        <div class="form-group">
          <label>When did your symptoms start and how long have they been going on for?</label>
          <textarea id="description" data-natural="Symptoms started" placeholder="Describe onset and duration..."></textarea>
        </div>
        <div class="form-group">
          <label>When was your last menstrual period</label>
          <input type="text" id="Last menstrual period-" data-natural="Last menstrual period" placeholder="Enter date..." />
        </div>
      </div>
    </div>

    <!-- Pain Assessment Card -->
    <div class="card">
      <div class="card-header" onclick="toggleCard(this)">
        <h3>Pain Assessment</h3>
        <span class="card-icon">▼</span>
      </div>
      <div class="card-content">
        <div class="form-group">
          <label>Where is the pain located</label>
          <input type="text" id="Pain located in" data-natural="Pain located in" placeholder="Describe location..." />
        </div>
        <div class="form-group">
          <label>Does the pain radiate to any other areas</label>
          <input type="text" id="Radiates to" data-natural="Radiates to" placeholder="Describe radiation..." />
        </div>
        <div class="form-group">
          <label>How would you describe the character of the pain</label>
          <input type="text" id="Character of pain is" data-natural="Character" placeholder="Sharp, dull, burning, etc..." />
        </div>
        <div class="form-group">
          <label>Are there any factors or activities that seem to be associated with the pain</label>
          <input type="text" id="Pain is associated with" data-natural="Associated with" placeholder="Eating, movement, etc..." />
        </div>
        <div class="form-group">
          <label>What provides relief from the pain</label>
          <input type="text" id="Alleviated by" data-natural="Relieved by" placeholder="Rest, medication, position..." />
        </div>
        <div class="form-group">
          <label>What makes the pain worse</label>
          <input type="text" id="Pain is exacerbated by" data-natural="Worsened by" placeholder="Movement, eating, etc..." />
        </div>
        <div class="form-group">
          <label>On a scale of 1 to 10, how would you rate the severity of the pain</label>
          <input type="text" id="Pain severity -" data-natural="Severity" placeholder="1-10 scale..." />
        </div>
      </div>
    </div>

    <!-- Red Flag Symptoms Card -->
    <div class="card red-flag-card" data-grid="redFlagGrid">
      <div class="card-header" onclick="toggleCard(this)">
        <h3>⚠️ Urgent Warning Signs</h3>
        <span class="state-counters">
          <span class="state-chip have" data-count-have="0">0 have</span>
          <span class="state-chip donthave" data-count-no="0">0 don't</span>
        </span>
        <span class="card-icon">▼</span>
      </div>
      <div class="card-content">
        <div class="ux-instruction"></div>
        <div class="symptom-grid" id="redFlagGrid">
          <div class="symptom-toggle" data-symptom="rigid abdomen">Rigid abdomen</div>
          <div class="symptom-toggle" data-symptom="bloody stool">Bloody stool</div>
          <div class="symptom-toggle" data-symptom="dark vomitus">Vomiting dark substance</div>
          <div class="symptom-toggle" data-symptom="blood in vomitus">Vomiting blood</div>
          <div class="symptom-toggle" data-symptom="unexplained weight loss">Unexplained weight loss</div>
          <div class="symptom-toggle" data-symptom="jaundice">Jaundice</div>
          <div class="symptom-toggle" data-symptom="abdominal swelling">Abdominal swelling</div>
          <div class="symptom-toggle" data-symptom="inability to pass stool">Inability to pass stool</div>
          <div class="symptom-toggle" data-symptom="inability to pass stool and gas">Inability to pass stool and gas</div>
          <div class="symptom-toggle" data-symptom="chest pain">Chest pain</div>
          <div class="symptom-toggle" data-symptom="shortness of breath">Shortness of breath</div>
          <div class="symptom-toggle" data-symptom="pain following an injury">Pain following an injury</div>
          <div class="symptom-toggle" data-symptom="cold, clammy skin">Cold, clammy skin</div>
          <div class="symptom-toggle" data-symptom="shallow breathing">Shallow breathing</div>
          <div class="symptom-toggle" data-symptom="rapid heartbeat">Rapid heartbeat</div>
        </div>
      </div>
    </div>

    <!-- Common Symptoms Card -->
    <div class="card" data-grid="commonGrid">
      <div class="card-header" onclick="toggleCard(this)">
        <h3>Common Symptoms</h3>
        <span class="state-counters">
          <span class="state-chip have" data-count-have="0">0 have</span>
          <span class="state-chip donthave" data-count-no="0">0 don't</span>
        </span>
        <span class="card-icon">▼</span>
      </div>
      <div class="card-content">
        <div class="ux-instruction"></div>
        <div class="symptom-grid" id="commonGrid">
          <div class="symptom-toggle" data-symptom="fever">Fever</div>
          <div class="symptom-toggle" data-symptom="loss of appetite">Loss of appetite</div>
          <div class="symptom-toggle" data-symptom="nausea">Nausea</div>
          <div class="symptom-toggle" data-symptom="vomiting">Vomiting</div>
          <div class="symptom-toggle" data-symptom="bloating">Bloating</div>
          <div class="symptom-toggle" data-symptom="back pain">Back pain</div>
          <div class="symptom-toggle" data-symptom="diarrhea">Diarrhea</div>
          <div class="symptom-toggle" data-symptom="constipation">Constipation</div>
        </div>
      </div>
    </div>

    <!-- Additional Symptoms Card -->
    <div class="card" data-grid="additionalGrid">
      <div class="card-header" onclick="toggleCard(this)">
        <h3>Additional Symptoms</h3>
        <span class="state-counters">
          <span class="state-chip have" data-count-have="0">0 have</span>
          <span class="state-chip donthave" data-count-no="0">0 don't</span>
        </span>
        <span class="card-icon">▼</span>
      </div>
      <div class="card-content">
        <div class="ux-instruction"></div>
        <div class="symptom-grid" id="additionalGrid">
          <div class="symptom-toggle" data-symptom="Pale stool">Pale stool</div>
          <div class="symptom-toggle" data-symptom="not passing gas">Inability to pass gas</div>
          <div class="symptom-toggle" data-symptom="abdominal distension">Abdominal distension</div>
          <div class="symptom-toggle" data-symptom="hematuria">Blood in urine</div>
          <div class="symptom-toggle" data-symptom="dysuria">Pain or discomfort while urinating</div>
          <div class="symptom-toggle" data-symptom="frequency">Increased frequency of urination</div>
          <div class="symptom-toggle" data-symptom="foul smelling urine">Foul-smelling urine</div>
          <div class="symptom-toggle" data-symptom="melena">Melena (black, tarry stools)</div>
        </div>
      </div>
    </div>

    <!-- Reproductive Health Card -->
    <div class="card" data-grid="reproductiveGrid">
      <div class="card-header" onclick="toggleCard(this)">
        <h3>Reproductive Health</h3>
        <span class="state-counters">
          <span class="state-chip have" data-count-have="0">0 have</span>
          <span class="state-chip donthave" data-count-no="0">0 don't</span>
        </span>
        <span class="card-icon">▼</span>
      </div>
      <div class="card-content">
        <div class="ux-instruction"></div>
        <div class="symptom-grid" id="reproductiveGrid">
          <div class="symptom-toggle" data-symptom="testicular pain">Testicular pain</div>
          <div class="symptom-toggle" data-symptom="urethral discharge">Urethral discharge</div>
          <div class="symptom-toggle" data-symptom="vaginal discharge">Vaginal discharge</div>
          <div class="symptom-toggle" data-symptom="dyspareunia">Pain during sexual intercourse</div>
          <div class="symptom-toggle" data-symptom="being sexually active">Currently sexually active</div>
          <div class="symptom-toggle" data-symptom="using contraception">Using contraception</div>
          <div class="symptom-toggle" data-symptom="doing a home pregnancy test">Done a home pregnancy test</div>
          <div class="symptom-toggle" data-symptom="positive pregnancy test">Positive pregnancy test</div>
          <div class="symptom-toggle" data-symptom="abdominal pain every time periods begin">Abdominal pain with periods</div>
          <div class="symptom-toggle" data-symptom="vaginal bleeding with clots">Vaginal bleeding with clots</div>
          <div class="symptom-toggle" data-symptom="vaginal bleeding with fetal tissue">Vaginal bleeding with fetal tissue</div>
        </div>
      </div>
    </div>

    <!-- Medical History Card -->
    <div class="card" data-grid="historyGrid">
      <div class="card-header" onclick="toggleCard(this)">
        <h3>Medical History</h3>
        <span class="state-counters">
          <span class="state-chip have" data-count-have="0">0 have</span>
          <span class="state-chip donthave" data-count-no="0">0 don't</span>
        </span>
        <span class="card-icon">▼</span>
      </div>
      <div class="card-content">
        <div class="ux-instruction"></div>
        <div class="symptom-grid" id="historyGrid">
          <div class="symptom-toggle conditions" data-symptom="irritable bowel disease">Irritable bowel disease</div>
          <div class="symptom-toggle conditions" data-symptom="inflammatory bowel disease">Inflammatory bowel disease</div>
          <div class="symptom-toggle conditions" data-symptom="diverticulosis">Diverticulosis</div>
          <div class="symptom-toggle conditions" data-symptom="pancreatitis">Pancreatitis</div>
          <div class="symptom-toggle conditions" data-symptom="gallstones">Gallstones</div>
          <div class="symptom-toggle conditions" data-symptom="appendicitis">Appendicitis</div>
          <div class="symptom-toggle conditions" data-symptom="abdominal surgery">Abdominal surgery</div>
          <div class="symptom-toggle conditions" data-symptom="pelvic surgery">Pelvic surgery</div>
          <div class="symptom-toggle conditions" data-symptom="AAA (Abdominal Aortic Aneurysm)">Abdominal Aortic Aneurysm (AAA)</div>
          <div class="symptom-toggle conditions" data-symptom="endometritis">Endometritis</div>
          <div class="symptom-toggle conditions" data-symptom="ectopic pregnancy">Ectopic pregnancy</div>
          <div class="symptom-toggle conditions" data-symptom="peptic ulcers">Peptic ulcers</div>
          <div class="symptom-toggle conditions" data-symptom="diabetes">Diabetes</div>
          <div class="symptom-toggle conditions" data-symptom="sickle cell disease">Sickle cell disease</div>
          <div class="symptom-toggle conditions" data-symptom="kidney stones">Kidney stones</div>
          <div class="symptom-toggle conditions" data-symptom="ischemic bowel disease">Ischemic bowel disease</div>
          <div class="symptom-toggle conditions" data-symptom="food allergy">Food allergy</div>
        </div>
      </div>
    </div>

    <!-- Medications & Lifestyle Card -->
    <div class="card">
      <div class="card-header" onclick="toggleCard(this)">
        <h3>Medications & Lifestyle</h3>
        <span class="card-icon">▼</span>
      </div>
      <div class="card-content">
        <div class="form-group">
          <label>Current medications</label>
          <input type="text" id="Currently taking -" data-natural="Currently taking" placeholder="List all current medications..." />
        </div>
        <div class="form-group">
          <label>Drug allergies</label>
          <input type="text" id="Drug Allergies -" data-natural="Drug allergies" placeholder="List any drug allergies and reactions..." />
        </div>
        <div class="form-group">
          <label>Other medical conditions</label>
          <input type="text" id="Past Medical History -" data-natural="Past medical history" placeholder="Any other conditions..." />
        </div>
        <div class="form-group">
          <label>Surgical history</label>
          <input type="text" id="Past Surgical History -" data-natural="Past surgical history" placeholder="Previous surgeries and dates..." />
        </div>
        <div class="form-group">
          <label>Response to previous treatments</label>
          <input type="text" id=" Response to previous treatments or interventions -" data-natural="Response to previous treatments" placeholder="Did previous treatments work?" />
        </div>
        <div class="form-group">
          <label>Smoking history</label>
          <input type="text" id="Smoking History -" data-natural="Smoking history" placeholder="Cigarettes per day, years..." />
        </div>
        <div class="form-group">
          <label>Alcohol use</label>
          <input type="text" id="Alcohol History -" data-natural="Alcohol history" placeholder="Drinks per week..." />
        </div>
        <div class="form-group">
          <label>Recreational drugs</label>
          <input type="text" id="Recreational drug use -" data-natural="Recreational drug use" placeholder="Type and frequency..." />
        </div>
      </div>
    </div>

    <!-- Expectations of Consultation Card -->
    <div class="card">
      <div class="card-header" onclick="toggleCard(this)">
        <h3>Expectations of Consultation</h3>
        <span class="card-icon">▼</span>
      </div>
      <div class="card-content">
        <div class="form-group">
          <label>Any other relevant details or requests for the doctor?</label>
          <textarea id="further-details" data-natural="Expectations of the consultation" class="expectations" placeholder="What are you hoping to achieve from this consultation?"></textarea>
        </div>
      </div>
    </div>
  </div>

  <!-- Enhanced Output Modal -->
  <div class="output-modal" id="outputModal">
    <div class="output-content">
      <div class="output-header">
        <h2>Symptom Report</h2>
        <button class="close-btn" onclick="closeOutput()">&times;</button>
      </div>
      <div class="output-body">
        <textarea id="outputText" placeholder="Your report will appear here. You can edit it before copying or emailing."></textarea>
        <div class="output-actions">
          <button class="action-btn" onclick="copyOutput()">Copy Report</button>
          <button class="action-btn" onclick="emailOutput()">Email Report</button>
        </div>
      </div>
    </div>
  </div>
<!-- Speech Widget -->
<div class="speech-widget" id="speechWidget" style="position: fixed; bottom: 20px; right: 20px; z-index: 10000; display: flex; flex-direction: column; align-items: center; gap: 8px;">
  <button class="speech-btn" type="button" title="Click to start/stop voice dictation" id="speechBtn">
    <svg class="mic-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M12 1a4 4 0 0 0-4 4v6a4 4 0 0 0 8 0V5a4 4 0 0 0-4-4z"/>
      <path d="M19 10v1a7 7 0 0 1-14 0v-1"/>
      <line x1="12" y1="19" x2="12" y2="23"/>
      <line x1="8" y1="23" x2="16" y2="23"/>
    </svg>
    <div class="pulse-ring"></div>
  </button>
  <div class="speech-status" id="speechStatus">Click to start dictation</div>
</div>







<!-- Add this script directly before closing </body> tag in your HTML -->
<script>
console.log("=== SPEECH WIDGET INLINE TEST ===");

// Test 1: Check if elements exist
const button = document.getElementById('speechBtn');
const status = document.getElementById('speechStatus');
const widget = document.getElementById('speechWidget');

console.log("Button found:", !!button);
console.log("Status found:", !!status);
console.log("Widget found:", !!widget);

// Test 2: Check browser support
const hasAPI = ('webkitSpeechRecognition' in window) || ('SpeechRecognition' in window);
const isSecure = location.protocol === 'https:' || location.hostname === 'localhost';

console.log("Has Speech API:", hasAPI);
console.log("Is secure context:", isSecure);
console.log("Current protocol:", location.protocol);

// Test 3: Add click handler directly
if (button) {
  console.log("Adding test click handler to button...");
  
  button.addEventListener('click', function(e) {
    console.log("BUTTON CLICKED!");
    e.preventDefault();
    
    if (!hasAPI) {
      alert("Speech Recognition API not available");
      return;
    }
    
    if (!isSecure) {
      alert("Speech Recognition requires HTTPS (currently on " + location.protocol + ")");
      return;
    }
    
    // Test microphone permissions
    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
      console.log("Testing microphone access...");
      
      navigator.mediaDevices.getUserMedia({ audio: true })
        .then(function(stream) {
          console.log("✅ Microphone access granted!");
          alert("Microphone access works! Now testing speech recognition...");
          
          // Stop the stream
          stream.getTracks().forEach(track => track.stop());
          
          // Test speech recognition
          testSpeechRecognition();
        })
        .catch(function(error) {
          console.error("❌ Microphone access denied:", error);
          alert("Microphone access denied: " + error.message);
        });
    } else {
      alert("MediaDevices API not available");
    }
  });
} else {
  console.error("❌ Speech button not found! Check your HTML.");
}

function testSpeechRecognition() {
  console.log("Testing speech recognition...");
  
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  const recognition = new SpeechRecognition();
  
  recognition.onstart = function() {
    console.log("✅ Speech recognition started!");
    alert("Speech recognition started! Say something...");
    
    if (button) {
      button.style.backgroundColor = 'red';
      button.classList.add('listening');
    }
    if (status) {
      status.textContent = 'Listening... speak now!';
    }
  };
  
  recognition.onresult = function(event) {
    const transcript = event.results[0][0].transcript;
    console.log("✅ Speech heard:", transcript);
    alert("I heard: " + transcript);
  };
  
  recognition.onerror = function(event) {
    console.error("❌ Speech recognition error:", event.error);
    alert("Speech recognition error: " + event.error);
  };
  
  recognition.onend = function() {
    console.log("Speech recognition ended");
    if (button) {
      button.style.backgroundColor = '';
      button.classList.remove('listening');
    }
    if (status) {
      status.textContent = 'Click to start dictation';
    }
  };
  
  try {
    recognition.start();
  } catch (error) {
    console.error("Failed to start recognition:", error);
    alert("Failed to start: " + error.message);
  }
}

console.log("=== TEST SETUP COMPLETE ===");
console.log("Click the microphone button to test!");
</script>



  

  
  <script src="speech-widget.js"></script>
  <script src="index.js"></script>
</body>
</html>
